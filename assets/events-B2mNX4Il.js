import"./style-C2KE1r0U.js";import{c as y}from"./index-BUiByx9r.js";const S="https://chmfytasgjopdwjbgtek.supabase.co",_="sb_publishable_NPUOTtf_Q1xAIydYRmhXpg_7sYmQqTg",f=y(S,_);let l=[],u=[],p={};const E={1:["edm","bass","experimental bass"],18:["new wave","synthpop","alt dance"],19:["new wave","alt dance"],20:["synthpop","dance"],21:["house","electronic"],22:["tech house","house"],23:["electronic","club"],24:["house","electronic"],25:["house","deep house"],26:["house"],27:["deep house","electronic"],48:["dubstep","tearout","edm"],53:["house"],54:["house","tech house"],55:["tech house"],56:["electronic","club"],57:["tech house","club"],58:["house"],59:["house","club"],60:["tech house"],62:["melodic bass","future bass","edm"],63:["future bass","edm"],64:["melodic dubstep","edm"],65:["future bass"],71:["livetronica","electronic","funk"],81:["house","tech house"],82:["tech house"],83:["house"],84:["tech house"],85:["house"],86:["house"],91:["dubstep","bass","edm"],92:["dubstep"],93:["bass","electronic"],94:["edm"],95:["dubstep","experimental bass"],99:["industrial","techno"],109:["afrobeat","funk rock","instrumental"],110:["funk","soul"],111:["instrumental rock"],119:["melodic house","progressive"],120:["melodic house"],121:["indie electronic"],139:["synthpop","indie electronic"],140:["indie electronic"],143:["chill electronic","nu jazz"],144:["downtempo","lofi electronic"],145:["electronic"],151:["bass house","edm"],152:["trance","progressive"],161:["drum and bass","edm"],165:["deep house","melodic house"],166:["melodic house"],167:["progressive house"],2:["alternative hip hop","trap"],3:["trap"],4:["emo rap"],5:["experimental hip hop"],6:["underground rap"],7:["hip hop"],127:["latin trap","hip hop"],128:["latin hip hop"],129:["trap"],130:["reggaeton"],146:["open format","hip hop","dance"],12:["doom metal"],13:["doom metal","sludge"],14:["heavy metal"],38:["melodic death metal"],39:["metalcore"],40:["death metal"],72:["deathcore"],73:["metalcore"],74:["hardcore"],75:["thrash metal"],76:["heavy psych"],77:["stoner metal"],96:["garage rock","punk"],97:["indie punk"],98:["psych rock"],103:["post metal"],104:["screamo"],105:["post hardcore"],107:["classic metal"],108:["hard rock"],153:["punk"],154:["hardcore punk"],155:["skate punk"],156:["hardcore"],157:["post punk"],158:["noise punk"],162:["punk"],163:["post punk"],164:["alternative rock"],8:["indie folk","americana"],9:["indie rock"],10:["folk"],11:["singer-songwriter"],15:["post punk","noise rock"],16:["noise rock"],17:["indie rock"],29:["emo","indie rock"],30:["emo"],31:["alt rock"],32:["indie rock"],34:["classic rock"],35:["indie rock"],36:["dream pop"],37:["shoegaze"],41:["blues"],47:["rockabilly","roots rock"],49:["indie rock"],50:["alternative rock"],51:["indie pop"],52:["garage rock"],66:["alt rock"],67:["psych rock"],68:["pop"],69:["singer-songwriter"],70:["acoustic pop"],78:["pop rock"],79:["alt pop"],80:["synth pop"],87:["funk","electronic"],88:["jam band"],89:["funk rock"],100:["americana"],101:["roots rock"],102:["country rock"],112:["jam band","funk"],113:["jam band"],114:["alt country"],115:["americana"],116:["gothic americana"],117:["alt country"],118:["folk rock"],122:["jam band"],123:["psychedelic rock"],136:["pop punk"],137:["alternative rock"],138:["emo pop"],33:["modern jazz"],41:["blues"],61:["straight ahead jazz"],90:["modern jazz"],100:["americana"],101:["blues rock"],102:["roots rock"],106:["modern jazz"],148:["jazz fusion"],149:["neo soul"],150:["funk jazz"],141:["80s pop","dance"],142:["90s pop","dance"],147:["disco","dance","abba"],18:["new wave","alt dance"],19:["synthpop"],20:["alt dance"],28:["dj","open format","dance"]};function m(t){const o=t.trim().split(`
`),n=o[0].split(",").map(e=>e.trim());return o.slice(1).map(e=>{const s=e.split(/,(?=(?:[^"]*"[^"]*")*[^"]*$)/),a={};return n.forEach((c,i)=>{a[c]=String(s[i]??"").trim().replace(/^"|"$/g,"")}),a})}async function h(t,o){try{const{data:n,error:e}=await f.from("clicks").insert([{event_id:t,action:o}]);e&&console.error("Supabase click error:",e)}catch(n){console.error("Supabase click exception:",n)}}function N(t){return t?t.split(",").map(o=>o.trim()).flatMap(o=>E[o]||[]):[]}function w(t){const o={};return t.forEach(n=>{const e=n.artistID?.trim();e&&(o[e]=n)}),o}function I(t,o){return t?t.split(",").map(n=>n.trim()).map(n=>o[n]?.name||"Unknown"):[]}function k(t){return[...t.filter(e=>{const s=(e.liveMusic||"").toString().toLowerCase().trim();return s==="yes"||s==="true"||s==="1"})].sort(()=>Math.random()-.5).slice(0,3).map(e=>({event:e,sim:null}))}function v(t,o){const n=document.getElementById("events-container");n.innerHTML="",t.forEach(({event:e,sim:s})=>{const a=I(e.artistIDs,o).join(", "),c=N(e.artistIDs).join(", ");let i=JSON.parse(sessionStorage.getItem("viewed_events")||"[]");i.includes(e.id)||(h(e.readableName,"viewed"),i.push(e.id),sessionStorage.setItem("viewed_events",JSON.stringify(i)));const r=document.createElement("div");r.className="event-card",r.innerHTML=`
      <h3>${e.eventName}</h3>
      <p><strong>Artists:</strong> ${a}</p>
      <p><strong>Genres:</strong> ${c}</p>
      <button class="not-interested-btn">Not Interested</button>
    `,r.addEventListener("click",d=>{if(d.target.classList.contains("not-interested-btn"))return;const g=t.map(b=>b.event.id);sessionStorage.setItem("last_recommended_event_ids",JSON.stringify(g)),console.log("Navigating to event ID:",e.id),window.location.href=`/denver-events-tool/event.html?id=${e.id}`}),r.querySelector(".not-interested-btn").addEventListener("click",async d=>{d.stopPropagation(),h(e.readableName,"not_interested"),r.remove()}),r.addEventListener("mouseenter",()=>r.style.transform="translateY(-3px)"),r.addEventListener("mouseleave",()=>r.style.transform="translateY(0)"),n.appendChild(r)})}Promise.all([fetch("/denver-events-tool/events.csv").then(t=>t.text()),fetch("/denver-events-tool/artists.csv").then(t=>t.text())]).then(([t,o])=>{l=m(t).map((s,a)=>(s.id=`event_${a}`,s.readableName=s.eventName,s)),u=m(o),p=w(u),localStorage.setItem("events_data",JSON.stringify(l)),localStorage.setItem("artists_data",JSON.stringify(u));const n=sessionStorage.getItem("last_recommended_event_ids");let e;n?e=JSON.parse(n).map(a=>{const c=l.find(i=>i.id===a);return c?{event:c,sim:null}:null}).filter(Boolean):e=k(l),v(e,p)});document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("shuffle-btn");t&&t.addEventListener("click",()=>{try{f.from("clicks").insert([{action:"shuffle"}])}catch(e){console.error("shuffle log failed",e)}const o=k(l);v(o,p);const n=o.map(e=>e.event.id);sessionStorage.setItem("last_recommended_event_ids",JSON.stringify(n))})});
