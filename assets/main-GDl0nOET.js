import{c as h}from"./index-VDz2wVCg.js";const v="https://chmfytasgjopdwjbgtek.supabase.co",g="sb_publishable_NPUOTtf_Q1xAIydYRmhXpg_7sYmQqTg",f=h(v,g);let c=[],m=[],l={};const E={1:["edm","bass","experimental bass"],18:["new wave","synthpop","alt dance"],19:["new wave","alt dance"],20:["synthpop","dance"],21:["house","electronic"],22:["tech house","house"],23:["electronic","club"],24:["house","electronic"],25:["house","deep house"],26:["house"],27:["deep house","electronic"],28:["dj","open format","dance"]};function d(e){const t=e.trim().split(`
`),s=t[0].split(",").map(n=>n.trim());return t.slice(1).map(n=>{const r=n.split(/,(?=(?:[^"]*"[^"]*")*[^"]*$)/),o={};return s.forEach((i,a)=>{o[i]=String(r[a]??"").trim().replace(/^"|"$/g,"")}),o})}function b(e,t){f.from("clicks").insert([{event_id:e,action:t}]).catch(console.error)}function _(e){return e?e.split(",").flatMap(t=>E[t.trim()]||[]):[]}function A(e){const t={};return e.forEach(s=>s.artistID&&(t[s.artistID.trim()]=s)),t}function I(e,t){return e?e.split(",").map(s=>t[s.trim()]?.name||"Unknown"):[]}function u(e){return e.filter(t=>["yes","true","1"].includes(String(t.liveMusic).toLowerCase())).sort(()=>Math.random()-.5).slice(0,3).map(t=>({event:t,sim:null}))}function p(e,t){const s=document.getElementById("events-container");s&&(s.innerHTML="",e.forEach(({event:n})=>{const r=document.createElement("div");r.className="event-card",r.innerHTML=`
      <h3>${n.eventName}</h3>
      <p><strong>Artists:</strong> ${I(n.artistIDs,t).join(", ")}</p>
      <p><strong>Genres:</strong> ${_(n.artistIDs).join(", ")}</p>
      <button class="not-interested-btn">Not Interested</button>
    `,r.addEventListener("click",i=>{i.target.classList.contains("not-interested-btn")||(sessionStorage.setItem("last_recommended_event_ids",JSON.stringify(e.map(a=>a.event.id))),window.location.href=`/event.html?id=${n.id}`)}),r.querySelector(".not-interested-btn")?.addEventListener("click",i=>{i.stopPropagation(),b(n.readableName,"not_interested"),r.remove()}),s.appendChild(r)}))}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("email-form");if(e){const n=document.getElementById("status-msg");e.addEventListener("submit",async r=>{r.preventDefault();const o=document.getElementById("email")?.value.trim();if(o)try{await f.from("emails").insert([{email:o}]),n.textContent="Email saved! Redirecting...",setTimeout(()=>{window.location.href="/events.html"},800)}catch{n.textContent="Error saving email."}})}document.getElementById("events-container")&&Promise.all([fetch("/events.csv").then(n=>n.text()),fetch("/artists.csv").then(n=>n.text())]).then(([n,r])=>{c=d(n).map((o,i)=>({...o,id:`event_${i}`,readableName:o.eventName})),m=d(r),l=A(m),p(u(c),l)}),document.getElementById("shuffle-btn")?.addEventListener("click",()=>{p(u(c),l)})});
