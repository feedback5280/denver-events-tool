import{c as h}from"./index-VDz2wVCg.js";const v="https://chmfytasgjopdwjbgtek.supabase.co",g="sb_publishable_NPUOTtf_Q1xAIydYRmhXpg_7sYmQqTg",p=h(v,g);let a=[],m=[],l={};const E={1:["edm","bass","experimental bass"],18:["new wave","synthpop","alt dance"],19:["new wave","alt dance"],20:["synthpop","dance"],21:["house","electronic"],22:["tech house","house"],23:["electronic","club"],24:["house","electronic"],25:["house","deep house"],26:["house"],27:["deep house","electronic"],28:["dj","open format","dance"]};function d(e){const s=e.trim().split(`
`),t=s[0].split(",").map(n=>n.trim());return s.slice(1).map(n=>{const r=n.split(/,(?=(?:[^"]*"[^"]*")*[^"]*$)/),o={};return t.forEach((i,c)=>{o[i]=String(r[c]??"").trim().replace(/^"|"$/g,"")}),o})}function b(e,s){p.from("clicks").insert([{event_id:e,action:s}]).catch(console.error)}function I(e){return e?e.split(",").flatMap(s=>E[s.trim()]||[]):[]}function L(e){const s={};return e.forEach(t=>t.artistID&&(s[t.artistID.trim()]=t)),s}function S(e,s){return e?e.split(",").map(t=>s[t.trim()]?.name||"Unknown"):[]}function _(e){return(e.eventName+"|"+e.venue+"|"+e.Date).toLowerCase().replace(/[^a-z0-9]+/g,"-")}function u(e){const s=["cervantes' other side","cervantes' masterpiece ballroom"];return e.filter(t=>["yes","true","1"].includes(String(t.liveMusic).toLowerCase())).filter(t=>s.includes(String(t.venue).trim().toLowerCase())).sort(()=>Math.random()-.5).slice(0,3).map(t=>({event:t,sim:null}))}function f(e,s){const t=document.getElementById("events-container");t&&(t.innerHTML="",e.forEach(({event:n})=>{const r=document.createElement("div");r.className="event-card",r.innerHTML=`
      <h3>${n.eventName}</h3>
      <p><strong>Artists:</strong> ${S(n.artistIDs,s).join(", ")}</p>
      <p><strong>Genres:</strong> ${I(n.artistIDs).join(", ")}</p>
      <button class="not-interested-btn">Not Interested</button>
    `,r.addEventListener("click",i=>{i.target.classList.contains("not-interested-btn")||(sessionStorage.setItem("last_recommended_event_ids",JSON.stringify(e.map(c=>c.event.id))),window.location.href=`/event.html?id=${n.id}`)}),r.querySelector(".not-interested-btn")?.addEventListener("click",i=>{i.stopPropagation(),b(n.readableName,"not_interested"),r.remove()}),t.appendChild(r)}))}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("email-form");if(e){const n=document.getElementById("status-msg");e.addEventListener("submit",async r=>{r.preventDefault();const o=document.getElementById("email")?.value.trim();if(o)try{await p.from("emails").insert([{email:o}]),n.textContent="Email saved! Redirecting...",setTimeout(()=>{window.location.href="/events.html"},800)}catch{n.textContent="Error saving email."}})}document.getElementById("events-container")&&Promise.all([fetch("/events.csv").then(n=>n.text()),fetch("/artists.csv").then(n=>n.text())]).then(([n,r])=>{a=d(n).map(o=>({...o,id:_(o),readableName:o.eventName})),localStorage.setItem("events_data",JSON.stringify(a)),m=d(r),l=L(m),f(u(a),l)}),document.getElementById("shuffle-btn")?.addEventListener("click",()=>{f(u(a),l)})});
